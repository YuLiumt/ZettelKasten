![[Lousto2020#Exploring the Small Mass Ratio Binary Black Hole Merger via Zeno's Dichotomy Approach]]

![[RIT Catalog]]

GW150914.rpar 只适用于 mass ratio 比较小的情况。可能原因：Number of refinements 选取不合理 `rlsm = 9`, `rlsp  = 5`

```
q = 36.0/29.0               # Mass ratio: q = mp/mm >= 1

# Estimated eventual AH radii
ahrp = mp * 1.0
ahrm = mm * 1.0

# Coordinate size of finest boxes around each BH
rp = ahrp * 1.2
rm = ahrm * 1.2

# Minimum acceptable radial grid spacing
hr_min = 2*0.96*M
maxrls = 9  # Essentially determines iteration counting

n_min = 24 # Cells across AHm radius
hfm_min = rm/n_min # Fine grid spacing for '-' BH
rlsm = 1 + int(log(hr_min/hfm_min,2)) # Number of refinements to attain hr_min
h0_min = hfm_min * 2**(rlsm-1) # RL0 Cartesian spacing

# Number of levels for '+' BH estimated to keep error in angular
# velocity the same as for the '-' BH, assuming vErr \propto v *
# (h0/2**(rls-1)/rAH)**8
rlsp = rlsm + log(ahrm/ahrp * (xp/-xm)**(1./8))/log(2)
rlsp = int(round(rlsp))

hr = h0_min * float(n_min)/float(n)
```

| simname         | param                          | result |
| --------------- | ------------------------------ | ------ |
| GW150914_test1  | chip = [0, 0,  0.81]           | ok     |
| GW150914_test2  | q = 5.0 & chip = [0, 0,  0.81] | fail   |
| GW150914_test3  | q = 5.0                        | fail   |
| GW150914_test4  | q = 10.0 & rlsp + 1            | fail   |
| GW150914_test5  | q = 10.0 & rlsp + 2            | fail   |
| GW150914_test6  | q = 10.0 & ahrp = mp * 0.5     | fail   |
| GW150914_test7  | q = 10.0 & N = 36              | fail   |
| GW150914_test8  | q = 5.0 & N = 36               | fail   |
| GW150914_test9  | q = 10.0 & N = 40              | fail   |
| GW150914_test10 | q = 10.0 & N = 44              | fail   |
| GW150914_test11 | q = 10.0 & N = 48              | fail   |
| GW150914_test11 | q = 5.0 & N = 52               |        |

基本都在 50M 处停止。

RIT Catalog 没有提供可参考的 parfile。

![[Huerta2019#Parameters]]

对比了下 GW150914.rpar 应该没有问题

## tools

![[Varma2019b#Surrogate models for precessing binary black hole simulations with unequal masses]]

```python
import gwsurrogate

sur = gwsurrogate.LoadSurrogate('NRSur7dq4')
m1 = bbh.m1
m2 = bbh.m2
q = bbh.mass_ratio
chiA = bbh.chi1
chiB = bbh.chi2
dt = 0.1        # timestep size, Units of M
f_low = bbh.Omega_orb / np.pi   # initial frequency, f_low=0 returns the full surrogate
t, h, dyn = sur(q, chiA, chiB, dt=dt, f_low=f_low) 
```

NRSur7dq4 应该只适用于圆轨道，这里椭率参数最难保持一致。

- Gravitational Wave
	- TODO: Match Factor
	![[GW_BBH002.png]]
- Mass
	- ![[QuasiLocalMeasures Thorn#Variable]]
	![[mass_BBH002.png]]
	- 这里的 Mass 和 TwoPunctures 的区别
- Spin
	- 这里的黑线是 NRSur7dq4Remnant 提供的结果。
	![[spin_BBH002.png]]
- [[Habib2019#Algorithm to characterize NR waveforms]]
	- ![[omega_BBH002.png]]
	

以上是BBH002的对比，BBH000相对来说没有这么好。 see surfinBH.ipynb

| BBH000          | SXS:BBH:0147                     | BBH002          | SXS:BBH:0042                                    |
| --------------- | -------------------------------- | --------------- | ----------------------------------------------- |
| Mass Ratio      | 1                                | Mass Ratio      | 3                                               |
| separation      | 10.4                             | separation      | 12                                              |
| chi1            | [-0.49999999994161404, 0.0, 0.0] | chi1            | [0.24999999998024666, 0.0, -0.4329999999657872] |
| chi2            | [0.49999999994161404, 0.0, 0.0]  | chi2            | [0.0, 0.0, 0.0]                                 |
| chi_eff         | 0.0                              | chi_eff         | -0.3247499999774751                             |
| chi_p           | 0.4999999999416141               | chi_p           | 0.24999999998024666                             |
| Omega_orb       | 0.027528062162941114             | Omega_orb       | 0.07249791459217449                             |
| CutoffFrequency | 0.04129209324441167              | CutoffFrequency | 0.10874687188826174                             |
| eccentricity    | 0.0222                           | eccentricity    | 0.00089？                                       | 


- BBH002 的轨迹很光滑
	![[trajectory_BBH002.png]]
- BBH000 的轨迹很凌乱
	![[trajectory_BBH000.png]]

## Other Questions

- bbh.Omega_orb: 

$$L_{NR} = x_{1}*p_{1y} + x_{2}*p_{2y}$$

$$L_{PN} = L(\omega, q, M, \chi_{1z}, \chi_{2z})$$

`TwoPunctures.bbh` 里提供了`initial-ADM-angular-momentumx`, `initial-ADM-angular-momentumy`, `initial-ADM-angular-momentumz`这三个量。有时 `initial-ADM-angular-momentumz` 等于上式的$L_{NR}$有时不等。

- QuasiLocalMeasures Thorn 里提供了 `qlm_adm_momentum` 和 `qlm_w_momentum` 怎么和 recoil kick velocity of the remnant black hole 对应起来。在 QuasiLocalMeasures 相关的文章里没有找到 recoil kick velocity 的定义。

## Convergence

![[Convergence_BBH000.png]]

看上去 `N=28` 相差比较大

| simname    | N   |
| ---------- | --- |
| BBH000Lev1 | 28  |
| BBH000Lev2 | 32  |
| BBH000Lev3 | 36  |
| BBH000Lev4 | 40  | 
